{% extends 'html/base.html' %}
{% load static %}
{% block title %}{{ product.name }} - AIMART{% endblock %}
{% block extra_css %}
<style>
  .product-container {
    max-width: 1200px;
    margin: 30px auto;
    padding: 0 20px;
  }

  .product-breadcrumbs {
    margin-bottom: 20px;
    color: #777;
    font-size: 14px;
  }

  .product-breadcrumbs a {
    color: #777;
    text-decoration: none;
    transition: color 0.3s;
  }

  .product-breadcrumbs a:hover {
    color: #ff8c00;
  }

  .product-details {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 40px;
    margin-bottom: 40px;
  }

  .product-gallery {
    position: relative;
  }

  .main-image {
    width: 100%;
    height: 400px;
    object-fit: cover;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
  }

  .optional-image {
    position: absolute;
    width: 100px;
    height: 100px;
    object-fit: cover;
    border-radius: 8px;
    bottom: 20px;
    right: 20px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
    cursor: pointer;
    transition: transform 0.3s;
    border: 3px solid white;
  }

  .optional-image:hover {
    transform: scale(1.1);
  }

  .product-info {
    padding: 20px;
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
  }

  .product-name {
    font-size: 28px;
    color: #333;
    margin: 0 0 15px;
  }

  .product-seller {
    display: flex;
    align-items: center;
    margin-bottom: 20px;
  }

  .seller-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    margin-right: 10px;
    object-fit: cover;
  }

  .seller-name {
    color: #666;
    font-size: 14px;
  }

  .seller-name a {
    color: #666;
    text-decoration: none;
    transition: color 0.3s;
  }

  .seller-name a:hover {
    color: #ff8c00;
  }

  .product-price {
    font-size: 32px;
    font-weight: bold;
    color: #ff8c00;
    margin-bottom: 20px;
  }

  .product-status {
    display: inline-block;
    padding: 5px 10px;
    border-radius: 4px;
    font-size: 14px;
    margin-bottom: 20px;
  }

  .status-active {
    background: #e8f5e9;
    color: #4caf50;
  }

  .status-inactive {
    background: #ffebee;
    color: #f44336;
  }

  .product-description {
    margin-bottom: 25px;
    line-height: 1.6;
    color: #555;
  }

  .product-actions {
    display: flex;
    gap: 10px;
    margin-top: 30px;
  }

  .action-btn {
    padding: 12px 25px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 16px;
    font-weight: 600;
    transition: all 0.3s;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
  }

  .btn-cart {
    background: #ff8c00;
    color: white;
    flex-grow: 1;
  }

  .btn-cart:hover {
    background: #e67e00;
  }

  .btn-favorite {
    background: #f8f8f8;
    color: #ff8c00;
    width: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .btn-favorite:hover {
    background: #ffe8d0;
  }

  .added-to-favorite {
    color: #ff8c00;
    background: #ffe8d0;
  }

  .product-meta {
    margin-top: 15px;
    color: #777;
    font-size: 14px;
  }

  .product-meta span {
    margin-right: 20px;
  }

  .image-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    z-index: 1000;
    justify-content: center;
    align-items: center;
  }

  .modal-content {
    max-width: 90%;
    max-height: 90%;
  }

  .modal-close {
    position: absolute;
    top: 20px;
    right: 20px;
    color: white;
    font-size: 30px;
    cursor: pointer;
  }

  .related-products {
    margin-top: 60px;
  }

  .related-title {
    font-size: 24px;
    color: #333;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 1px solid #eee;
  }

  .related-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 20px;
  }

  .related-product {
    background: white;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    transition: transform 0.3s, box-shadow 0.3s;
  }

  .related-product:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
  }

  .related-image {
    width: 100%;
    height: 180px;
    object-fit: cover;
  }

  .related-info {
    padding: 15px;
  }

  .related-name {
    font-size: 16px;
    font-weight: 600;
    margin-bottom: 10px;
    color: #333;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    height: 42px;
  }

  .related-price {
    font-size: 18px;
    font-weight: 700;
    color: #ff8c00;
  }

  .product-created {
    color: #999;
    font-size: 14px;
    margin-top: 5px;
  }

  @media (max-width: 768px) {
    .product-details {
      grid-template-columns: 1fr;
    }

    .main-image {
      height: 300px;
    }

    .related-grid {
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
    }
  }
</style>
{% endblock %}

{% block content %}
<div class="product-container">
  <div class="product-breadcrumbs">
    <a href="{% url 'home' %}">Главная</a> &gt;
    <a href="{% url 'catalog' %}">Каталог</a> &gt;
    <span>{{ product.name }}</span>
  </div>

  <div class="product-details">
    <div class="product-gallery">
      {% if product.image_main %}
      <img
        src="{{ product.image_main.url }}"
        alt="{{ product.name }}"
        class="main-image"
        id="mainImage"
      />
      {% else %}
      <div
        class="main-image"
        style="background-color: #eee; display: flex; align-items: center; justify-content: center;"
      >
        <span>Нет фото</span>
      </div>
      {% endif %}
      {% if product.image_optional %}
      <img
        src="{{ product.image_optional.url }}"
        alt="{{ product.name }}"
        class="optional-image"
        id="optionalImage"
      />
      {% endif %}
    </div>

    <div class="product-info">
      <h1 class="product-name">{{ product.name }}</h1>

      <div class="product-seller">
        {% if product.seller.avatar %}
        <img
          src="{{ product.seller.avatar.url }}"
          alt="{{ product.seller.full_name }}"
          class="seller-avatar"
        />
        {% else %}
        <div
          class="seller-avatar"
          style="background-color: #ddd; display: flex; align-items: center; justify-content: center;"
        >
          <span Нет фото</span>
            </div>
            {% endif %}
            <div class="seller-name">
            Продавец: <a href="{% url 'seller_profile' product.seller.id %}">{{ product.seller.full_name }}</a>
            </div>
            </div>  <div class="product-price">{{ product.price }} ₽</div>

 <div class="product-status {% if product.is_active %}status-active{% else %}status-inactive{% endif %}">
  {% if product.is_active %}Активен{% else %}Неактивен{% endif %}
</div>


  <div class="product-description">
    <h2>Описание</h2>
    <p>{{ product.description|safe }}</p>
  </div>

  <div class="product-actions">
    <button class="action-btn btn-cart" onclick="addToCart()">Добавить в корзину</button>
    <button
      class="action-btn btn-favorite {% if product in user_favorites %}added-to-favorite{% endif %}"
      onclick="addToFavorites()"
    >
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"
          fill="#ff8c00"
        />
      </svg>
    </button>
  </div>

  <div class="product-meta">
    <span>Дата создания: {{ product.created_at|date:"d.m.Y" }}</span>
  </div>
</div>
</div> <div class="related-products"> <h2 class="related-title">Похожие товары</h2> {% include 'html/components/product_grid.html' with 
  products=related_products 
  show_seller=False
  show_rating=True
  show_discount=True
  grid_class="compact"
  empty_title="Похожих товаров не найдено"
  empty_message="В данный момент нет товаров, похожих на этот"
  empty_action_url="/catalog/"
  empty_action_text="Перейти в каталог"
%} </div> {% endblock %}
{% block extra_js %}

<script> function addToCart() { alert("Товар добавлен в корзину!"); } function addToFavorites() { alert("Товар добавлен в избранное!"); const favoriteBtn = document.querySelector(".btn-favorite"); favoriteBtn.classList.toggle("added-to-favorite"); } </script>
{% endblock %}