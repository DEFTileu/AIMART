{% extends 'html/main/base.html' %}
{% load static %}

{% block title %}–ì–ª–∞–≤–Ω–∞—è - AIMART{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/banner/banners.css' %}">
{% endblock %}

{% block content %}
<!-- Hero Banner Section -->
<section class="hero-banner" style="margin-top:10%">
    <div class="banner-carousel">
        {% for banner in banners %}
        <div class="banner-slide{% if forloop.first %} active{% endif %}">
            {% if banner.button_url %}
                {% if not banner.button_text %}
                    <a href="{{ banner.button_url }}">
                        <img src="{{ banner.image.url }}" alt="{{ banner.title }}" class="banner-image" style="cursor:pointer;">
                    </a>
                {% elif banner.button_text|lower == 'empty' %}
                    <a href="{{ banner.button_url }}">
                        <img src="{{ banner.image.url }}" alt="{{ banner.title }}" class="banner-image" style="cursor:pointer;">
                    </a>
                {% else %}
                    <img src="{{ banner.image.url }}" alt="{{ banner.title }}" class="banner-image">
                {% endif %}
            {% else %}
                <img src="{{ banner.image.url }}" alt="{{ banner.title }}" class="banner-image">
            {% endif %}
            {% if banner.button_text and banner.button_text|lower != 'empty' %}
            <div class="banner-caption">
                <h2 class="banner-title">{{ banner.title }}</h2>
                {% if banner.description %}<p class="banner-desc">{{ banner.description }}</p>{% endif %}
                {% if banner.button_url %}
                <a href="{{ banner.button_url }}" class="banner-btn">{{ banner.button_text|default:'–ü–æ–¥—Ä–æ–±–Ω–µ–µ' }}</a>
                {% endif %}
            </div>
            {% endif %}
        </div>
        {% empty %}
        <div class="banner-slide active">
            <img src="{% static 'images/banner.png' %}" alt="–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ AIMART" class="banner-image">
            <div class="banner-caption">
                <h2 class="banner-title">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ AIMART</h2>
                <a href="{% url 'catalog' %}" class="banner-btn">–°–º–æ—Ç—Ä–µ—Ç—å –∫–∞—Ç–∞–ª–æ–≥</a>
            </div>
        </div>
        {% endfor %}
        <button class="banner-nav banner-prev" aria-label="–ü—Ä–µ–¥—ã–¥—É—â–∏–π –±–∞–Ω–Ω–µ—Ä"><i class="fas fa-chevron-left"></i></button>
        <button class="banner-nav banner-next" aria-label="–°–ª–µ–¥—É—é—â–∏–π –±–∞–Ω–Ω–µ—Ä"><i class="fas fa-chevron-right"></i></button>
        <button id="banner-pause-btn" class="banner-pause-btn" aria-label="–ü–∞—É–∑–∞"><i class="fas fa-pause"></i></button>
        <div class="banner-dots-center">
            {% for banner in banners %}
            <button class="banner-dot{% if forloop.first %} active{% endif %}" data-index="{{ forloop.counter0 }}" aria-label="–ü–µ—Ä–µ–π—Ç–∏ –∫ –±–∞–Ω–Ω–µ—Ä—É {{ forloop.counter }}"></button>
            {% endfor %}
        </div>
    </div>
</section>

<!-- About Section -->
<section class="about-section">
    <div class="about-container">
    </div>
    <div class="about-features">
        <div class="feature-item">
            <div class="feature-icon">üöö</div>
            <h3 class="feature-title">–ë—ã—Å—Ç—Ä–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞</h3>
            <p class="feature-desc">–î–æ—Å—Ç–∞–≤–ª—è–µ–º –∑–∞–∫–∞–∑—ã –ø–æ –≤—Å–µ–º—É –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—É –≤ –∫—Ä–∞—Ç—á–∞–π—à–∏–µ —Å—Ä–æ–∫–∏</p>
        </div>
        <div class="feature-item">
            <div class="feature-icon">üí∏</div>
            <h3 class="feature-title">–õ—É—á—à–∏–µ —Ü–µ–Ω—ã</h3>
            <p class="feature-desc">–†–µ–≥—É–ª—è—Ä–Ω—ã–µ –∞–∫—Ü–∏–∏ –∏ —Å–∫–∏–¥–∫–∏ –¥–ª—è –Ω–∞—à–∏—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –≤ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–µ</p>
        </div>
        <div class="feature-item">
            <div class="feature-icon">üîí</div>
            <h3 class="feature-title">–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–ø–ª–∞—Ç–∞</h3>
            <p class="feature-desc">–ù–∞–¥—ë–∂–Ω—ã–µ –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã –≤ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–µ</p>
        </div>
        <div class="feature-item">
            <div class="feature-icon">üëç</div>
            <h3 class="feature-title">–ì–∞—Ä–∞–Ω—Ç–∏—è –∫–∞—á–µ—Å—Ç–≤–∞</h3>
            <p class="feature-desc">–¢—â–∞—Ç–µ–ª—å–Ω–æ –æ—Ç–±–∏—Ä–∞–µ–º –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ —Ç–æ–≤–∞—Ä—ã –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞</p>
        </div>
    </div>
</section>

<!-- Products Section -->
<section class="products-section">
    <h2 class="section-title">–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã</h2>
    {% include 'html/components/product_grid.html' with products=products show_seller=True show_rating=True grid_class="compact" %}
    </div>
    <div style="text-align: center; margin-top: 2rem;">
        <a href="{% url 'catalog' %}" class="banner-btn">–°–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ —Ç–æ–≤–∞—Ä—ã</a>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
(function() {
    let carousel = document.querySelector('.banner-carousel');
    let slides = carousel.querySelectorAll('.banner-slide');
    let dots = carousel.querySelectorAll('.banner-dot');
    let pauseBtn = document.getElementById('banner-pause-btn');
    let prevBtn = carousel.querySelector('.banner-prev');
    let nextBtn = carousel.querySelector('.banner-next');
    let current = 0;
    let paused = false;
    let pauseTimeout = null;
    let interval = 5000;
    let autoSwitch;

    function showSlide(idx) {
        slides.forEach((slide, i) => {
            slide.classList.toggle('active', i === idx);
            dots[i].classList.toggle('active', i === idx);
        });
        current = idx;
    }

    function nextSlide() {
        let next = (current + 1) % slides.length;
        showSlide(next);
    }
    function prevSlide() {
        let prev = (current - 1 + slides.length) % slides.length;
        showSlide(prev);
    }

    function startAuto() {
        if (autoSwitch) clearInterval(autoSwitch);
        autoSwitch = setInterval(() => {
            if (!paused) nextSlide();
        }, interval);
    }

    dots.forEach((dot, i) => {
        dot.addEventListener('click', () => {
            showSlide(i);
        });
    });
    if (prevBtn) prevBtn.addEventListener('click', prevSlide);
    if (nextBtn) nextBtn.addEventListener('click', nextSlide);

    pauseBtn.addEventListener('click', function() {
        paused = !paused;
        this.innerHTML = paused ? '<i class="fas fa-play"></i>' : '<i class="fas fa-pause"></i>';
        if (paused) {
            if (pauseTimeout) clearTimeout(pauseTimeout);
            pauseTimeout = setTimeout(() => {
                paused = false;
                pauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
            }, 120000); // 2 –º–∏–Ω—É—Ç—ã
        } else {
            if (pauseTimeout) clearTimeout(pauseTimeout);
        }
    });

    startAuto();
})();
</script>
{% endblock %}